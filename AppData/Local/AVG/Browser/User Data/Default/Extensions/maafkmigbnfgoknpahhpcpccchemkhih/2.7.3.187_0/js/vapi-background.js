"use strict";{const e=self.browser,t=e.runtime.getManifest();if(vAPI.cantWebsocket=e.webRequest.ResourceType instanceof Object==0||"websocket"!==e.webRequest.ResourceType.WEBSOCKET,vAPI.canWASM=!1===vAPI.webextFlavor.soup.has("chromium"),!1===vAPI.canWASM){const e=t.content_security_policy;vAPI.canWASM=void 0!==e&&-1!==e.indexOf("'wasm-eval'")}vAPI.supportsUserStylesheets=vAPI.webextFlavor.soup.has("user_stylesheet"),window.addEventListener("webextFlavor",(function(){vAPI.supportsUserStylesheets=vAPI.webextFlavor.soup.has("user_stylesheet")}),{once:!0}),vAPI.randomToken=function(){const e=Math.random();return String.fromCharCode(26*e+97)+Math.floor((.25+.75*e)*Number.MAX_SAFE_INTEGER).toString(36).slice(-8)},vAPI.app={name:t.name.replace(/ dev\w+ build/,""),version:(()=>{let e=t.version;const n=/(\d+\.\d+\.\d+)(?:\.(\d+))?/.exec(e);if(n&&n[2]){const t=parseInt(n[2],10);e=n[1]+(t<100?"b"+t:"rc"+(t-100))}return e})(),intFromVersion:function(e){const t=e.match(/(?:^|\.|b|rc)\d+/g);if(null===t)return 0;let n=0;for(let e=0;e<4;e++){const s=t[e]||"";let o;o=""===s?0:s.startsWith(".")||s.startsWith("b")?parseInt(s.slice(1),10):s.startsWith("rc")?parseInt(s.slice(2),10)+100:parseInt(s,10),n=1e3*n+o}return n},restart:function(){e.runtime.reload()}},vAPI.storage=webext.storage.local,vAPI.browserSettings=(()=>{const e=webext.privacy;if(e instanceof Object!=0)return{webRTCSupported:!1===vAPI.webextFlavor.soup.has("chromium")||void 0,setWebrtcIPAddress:function(t){if(void 0===this.webRTCSupported){if(t)return;this.webRTCSupported={setting:t};let e=document.createElement("iframe");const n=t=>{if(t.origin!==self.location.origin)return;window.removeEventListener("message",n);const s=this.webRTCSupported.setting;this.webRTCSupported="webRTCSupported"===t.data,this.setWebrtcIPAddress(s),e.parentNode.removeChild(e),e=null};return window.addEventListener("message",n),e.src="is-webrtc-supported.html",void document.body.appendChild(e)}if("object"==typeof this.webRTCSupported)return void(this.webRTCSupported.setting=t);if(!0!==this.webRTCSupported)return;const n=e.network;if(t)n.webRTCIPHandlingPolicy.clear({scope:"regular"});else{const e=!1===vAPI.webextFlavor.soup.has("firefox")||vAPI.webextFlavor.major<70?"default_public_interface_only":"disable_non_proxied_udp";n.webRTCIPHandlingPolicy.set({value:e,scope:"regular"})}},set:function(t){for(const n in t)if(!1!==t.hasOwnProperty(n))switch(n){case"prefetching":const s=!!t[n];s?e.network.networkPredictionEnabled.clear({scope:"regular"}):e.network.networkPredictionEnabled.set({value:!1,scope:"regular"}),vAPI.prefetching instanceof Function&&vAPI.prefetching(s);break;case"hyperlinkAuditing":t[n]?e.websites.hyperlinkAuditingEnabled.clear({scope:"regular"}):e.websites.hyperlinkAuditingEnabled.set({value:!1,scope:"regular"});break;case"webrtcIPAddress":this.setWebrtcIPAddress(!!t[n])}}}})(),vAPI.isBehindTheSceneTabId=function(e){return e<0},vAPI.unsetTabId=0,vAPI.noTabId=-1;const n=function(e){return"number"==typeof e&&!1===isNaN(e)?e:0};vAPI.Tabs=class{constructor(){e.webNavigation.onCreatedNavigationTarget.addListener((e=>{"string"!=typeof e.url&&(e.url=""),!1===/^https?:\/\//.test(e.url)&&(e.frameId=0,e.url=this.sanitizeURL(e.url),this.onNavigation(e)),this.onCreated(e)})),e.webNavigation.onCommitted.addListener((e=>{e.url=this.sanitizeURL(e.url),this.onNavigation(e)})),e.tabs.onUpdated.addListener(((e,t,n)=>{"string"!=typeof t.url&&(t.url=n&&n.url),t.url&&(t.url=this.sanitizeURL(t.url)),this.onUpdated(e,t,n)})),e.tabs.onActivated.addListener((e=>{this.onActivated(e)})),e.windows instanceof Object&&e.windows.onFocusChanged.addListener((async t=>{if(t===e.windows.WINDOW_ID_NONE)return;const n=await vAPI.tabs.query({active:!0,windowId:t});if(0===n.length)return;const s=n[0];this.onActivated({tabId:s.id,windowId:s.windowId})})),e.tabs.onRemoved.addListener(((e,t)=>{this.onClosed(e,t)}))}async executeScript(){let e;try{e=await webext.tabs.executeScript(...arguments)}catch(e){}return Array.isArray(e)?e:[]}async get(e){if(null===e)return this.getCurrent();if(e<=0)return null;let t;try{t=await webext.tabs.get(e)}catch(e){}return t instanceof Object?t:null}async getCurrent(){const e=await this.query({active:!0,currentWindow:!0});return 0!==e.length?e[0]:null}async insertCSS(e,t){vAPI.supportsUserStylesheets&&(t.cssOrigin="user");try{await webext.tabs.insertCSS(...arguments)}catch(e){}}async query(e){let t;try{t=await webext.tabs.query(e)}catch(e){}return Array.isArray(t)?t:[]}async removeCSS(e,t){vAPI.supportsUserStylesheets&&(t.cssOrigin="user");try{await webext.tabs.removeCSS(...arguments)}catch(e){}}async create(t,s){void 0===s.active&&(s.active=!0);const o=async()=>{const o={url:t,active:!!s.active},r=e=>{e.active&&vAPI.windows instanceof Object&&vAPI.windows.update(e.windowId,{focused:!0})};if(!s.tabId)return void 0!==s.index&&(o.index=s.index),void e.tabs.create(o,r);const a=await vAPI.tabs.update(n(s.tabId),o);null===a?e.tabs.create(o,r):void 0!==s.index&&e.tabs.move(a.id,{index:s.index})};if(void 0!==s.popup&&vAPI.windows instanceof Object){const e={url:s.url,type:s.popup};s.box instanceof Object&&Object.assign(e,s.box);const t=await vAPI.windows.create(e);if(null===t)return;if(s.box instanceof Object==0)return;if(t.left===s.box.left&&t.top===s.box.top)return;return void vAPI.windows.update(t.id,{left:s.box.left,top:s.box.top})}if(-1!==s.index)return void o();const r=await vAPI.tabs.getCurrent();s.index=null!==r?r.index+1:void 0,o()}async open(e){let t=e.url;if("string"!=typeof t||""===t)return null;if(!0!==/^[\w-]{2,}:/.test(t)&&(t=vAPI.getURL(t)),!e.select)return void this.create(t,e);if(vAPI.webextFlavor.soup.has("firefox")&&vAPI.webextFlavor.major<56)return void this.create(t,e);const n=t.indexOf("#"),s=-1===n?t:t.slice(0,n),o=await vAPI.tabs.query({url:s});if(0===o.length)return void this.create(t,e);let r=o[0];const a={active:!0};!1===r.url.startsWith(t)&&(a.url=t),r=await vAPI.tabs.update(r.id,a),vAPI.windows instanceof Object!=0&&vAPI.windows.update(r.windowId,{focused:!0})}async update(){let e;try{e=await webext.tabs.update(...arguments)}catch(e){}return e instanceof Object?e:null}replace(e,t){if(0===(e=n(e)))return;let s=t;!0!==/^[\w-]{2,}:/.test(s)&&(s=vAPI.getURL(s)),vAPI.tabs.update(e,{url:s})}async remove(e){if(0!==(e=n(e)))try{await webext.tabs.remove(e)}catch(e){}}async reload(e,t=!1){if(0!==(e=n(e)))try{await webext.tabs.reload(e,{bypassCache:!0===t})}catch(e){}}async select(e){if(0===(e=n(e)))return;const t=await vAPI.tabs.update(e,{active:!0});null!==t&&vAPI.windows instanceof Object!=0&&vAPI.windows.update(t.windowId,{focused:!0})}sanitizeURL(e){if(!1===e.startsWith("data:"))return e;const t=e.indexOf(",");if(-1===t)return e;const n=e.slice(0,t);return-1===n.search(/\s/)?e:n.replace(/\s+/,"")+e.slice(t)}onActivated(){}onClosed(){}onCreated(){}onNavigation(){}onUpdated(){}},webext.windows instanceof Object&&(vAPI.windows={get:async function(){let e;try{e=await webext.windows.get(...arguments)}catch(e){}return e instanceof Object?e:null},create:async function(){let e;try{e=await webext.windows.create(...arguments)}catch(e){}return e instanceof Object?e:null},update:async function(){let e;try{e=await webext.windows.update(...arguments)}catch(e){}return e instanceof Object?e:null}}),webext.browserAction instanceof Object&&(vAPI.browserAction={setTitle:async function(){try{await webext.browserAction.setTitle(...arguments)}catch(e){}}},webext.browserAction.setIcon&&(vAPI.browserAction.setBadgeTextColor=async function(){try{await webext.browserAction.setBadgeTextColor(...arguments)}catch(e){}},vAPI.browserAction.setBadgeBackgroundColor=async function(){try{await webext.browserAction.setBadgeBackgroundColor(...arguments)}catch(e){}},vAPI.browserAction.setBadgeText=async function(){try{await webext.browserAction.setBadgeText(...arguments)}catch(e){}},vAPI.browserAction.setIcon=async function(){try{await webext.browserAction.setIcon(...arguments)}catch(e){}})),vAPI.setIcon=(()=>{const t=vAPI.browserAction,s=e.runtime.getManifest().browser_action.default_title+" ({badge})",o=[{path:{16:"img/icon_16-off.png",32:"img/icon_32-off.png"}},{path:{16:"img/icon_16.png",32:"img/icon_32.png"}}];return(()=>{if(void 0===t.setIcon)return;if(void 0!==t.setBadgeBackgroundColor&&t.setBadgeBackgroundColor({color:"#666666"}),void 0!==t.setBadgeTextColor&&t.setBadgeTextColor({color:"#FFFFFF"}),!1===vAPI.webextFlavor.soup.has("chromium"))return;const e=[];for(let t=0;t<o.length;t++){const n=o[t].path;for(const s in n)!1!==n.hasOwnProperty(s)&&e.push({i:t,p:s})}const n=function(e,t,n){let s;try{s=e.getImageData(0,0,t,n)}catch(e){}return s},s=function(){for(const t of e)if(!1===t.r.complete)return;const t=document.createElement("canvas").getContext("2d"),s=[null,null];for(const o of e){const e=o.r.naturalWidth,r=o.r.naturalHeight;t.width=e,t.height=r,t.clearRect(0,0,e,r),t.drawImage(o.r,0,0),null===s[o.i]&&(s[o.i]={});const a=n(t,e,r);if(a instanceof Object==0||a.data instanceof Uint8ClampedArray==0||0!==a.data[0]||0!==a.data[1]||0!==a.data[2]||0!==a.data[3])return;s[o.i][o.p]=a}for(let e=0;e<s.length;e++)s[e]&&(o[e]={imageData:s[e]})};for(const t of e)t.r=new Image,t.r.addEventListener("load",s,{once:!0}),t.r.src=o[t.i].path[t.p]})(),async function(e,r){if(0===(e=n(e)))return;const a=await vAPI.tabs.get(e);if(null===a)return;const{parts:i,state:c,badge:l,color:d}=r;void 0!==t.setIcon&&(void 0!==i&&0==(1&i)||t.setIcon(Object.assign({tabId:a.id},o[c])),0!=(2&i)&&t.setBadgeText({tabId:a.id,text:0==(8&i)?l:""}),0!=(4&i)&&t.setBadgeBackgroundColor({tabId:a.id,color:d})),void 0===t.setTitle||void 0!==t.setIcon&&0==(8&i)||t.setTitle({tabId:a.id,title:s.replace("{badge}",1===c?""!==l?l:"0":"off")}),vAPI.contextMenu instanceof Object&&vAPI.contextMenu.onMustUpdate(e)}})(),e.browserAction.onClicked.addListener((function(e){vAPI.tabs.open({select:!0,url:"popup.html?tabId="+e.id+"&responsive=1"})})),vAPI.messaging={ports:new Map,listeners:new Map,defaultHandler:null,PRIVILEGED_URL:vAPI.getURL(""),NOOPFUNC:function(){},UNHANDLED:"vAPI.messaging.notHandled",listen:function(e){this.listeners.set(e.name,{fn:e.listener,privileged:!0===e.privileged})},onPortDisconnect:function(e){this.ports.delete(e.name)},onPortConnect:function(e){e.onDisconnect.addListener((e=>this.onPortDisconnect(e))),e.onMessage.addListener(((e,t)=>this.onPortMessage(e,t)));const t={port:e},n=e.sender,{tab:s,url:o}=n;t.frameId=n.frameId,t.frameURL=o,t.privileged=o.startsWith(this.PRIVILEGED_URL),s&&(t.tabId=s.id,t.tabURL=s.url),this.ports.set(e.name,t),e.sender=void 0},setup:function(t){null===this.defaultHandler&&("function"!=typeof t&&(t=function(){return this.UNHANDLED}),this.defaultHandler=t,e.runtime.onConnect.addListener((e=>this.onPortConnect(e))),vAPI.webextFlavor.soup.has("firefox")&&vAPI.webextFlavor.major<61&&e.tabs.onRemoved.addListener((e=>{for(const{port:t,tabId:n}of this.ports.values())n===e&&this.onPortDisconnect(t)})))},broadcast:function(e){const t={broadcast:!0,msg:e};for(const{port:e}of this.ports.values())try{e.postMessage(t)}catch(t){this.onPortDisconnect(e)}},onFrameworkMessage:function(e,t,n){const s=this.ports.get(t.name)||{},o=s.tabId,r=e.msg;switch(r.what){case"connectionAccepted":case"connectionRefused":{const n=this.ports.get(r.fromToken);void 0!==n?(r.tabId=o,n.port.postMessage(e)):(r.what="connectionBroken",t.postMessage(e));break}case"connectionRequested":r.tabId=o;for(const{port:n}of this.ports.values())if(n!==t)try{n.postMessage(e)}catch(e){this.onPortDisconnect(n)}break;case"connectionBroken":case"connectionCheck":case"connectionMessage":{const n=this.ports.get(t.name===r.fromToken?r.toToken:r.fromToken);void 0!==n?(r.tabId=o,n.port.postMessage(e)):(r.what="connectionBroken",t.postMessage(e));break}case"extendClient":vAPI.tabs.executeScript(o,{file:"/js/vapi-client-extra.js",frameId:s.frameId}).then((()=>{n()}));break;case"localStorage":{if(!0!==s.privileged)break;const e=r.args||[];vAPI.localStorage[r.fn](...e).then((e=>{n(e)}));break}case"userCSS":if(void 0===o)break;const a=[];if(r.add){const e={code:void 0,frameId:s.frameId,matchAboutBlank:!0,runAt:"document_start"};for(const t of r.add)e.code=t,a.push(vAPI.tabs.insertCSS(o,e))}if(r.remove){const e={code:void 0,frameId:s.frameId,matchAboutBlank:!0};for(const t of r.remove)e.code=t,a.push(vAPI.tabs.removeCSS(o,e))}Promise.all(a).then((()=>{n()}))}},CallbackWrapper:class{constructor(e,t,n){this.messaging=e,this.callback=this.proxy.bind(this),this.init(t,n)}init(e,t){return this.port=e,this.msgId=t,this}proxy(e){this.messaging.ports.has(this.port.name)&&this.port.postMessage({msgId:this.msgId,msg:void 0!==e?e:null}),this.port=null,this.messaging.callbackWrapperJunkyard.push(this)}},callbackWrapperJunkyard:[],callbackWrapperFactory:function(e,t){return 0!==this.callbackWrapperJunkyard.length?this.callbackWrapperJunkyard.pop().init(e,t):new this.CallbackWrapper(this,e,t)},onPortMessage:function(e,t){let n=this.NOOPFUNC;if(void 0!==e.msgId&&(n=this.callbackWrapperFactory(t,e.msgId).callback),"vapi"===e.channel)return void this.onFrameworkMessage(e,t,n);const s=this.ports.get(t.name);if(void 0===s)return;const o=this.listeners.get(e.channel);let r=this.UNHANDLED;void 0===o||!1!==o.privileged&&!s.privileged||(r=o.fn(e.msg,s,n)),r===this.UNHANDLED&&(s.privileged&&(r=this.defaultHandler(e.msg,s,n),r!==this.UNHANDLED)||(log.info(`vAPI.messaging.onPortMessage > unhandled request: ${JSON.stringify(e.msg)}`,e),n()))}},vAPI.warSecret=(()=>{const t=vAPI.getURL("/"),n=[];let s=0;return e.webRequest.onBeforeRequest.addListener((function(e){const t=e.url,s=n.findIndex((e=>-1!==t.lastIndexOf(`?secret=${e}`)));if(-1===s)return{cancel:!0};n.splice(s,1)}),{urls:[t+"web_accessible_resources/*"]},["blocking"]),()=>{0!==n.length&&(Date.now()-s>5e3?n.splice(0):n.length>256&&n.splice(0,n.length-192)),s=Date.now();const e=Math.floor(982451653*Math.random()+982451653).toString(36);return n.push(e),e}})(),vAPI.Net=class{constructor(){this.validTypes=new Set;{const t=e.webRequest.ResourceType;for(const e in t)t.hasOwnProperty(e)&&this.validTypes.add(t[e])}this.suspendableListener=void 0,this.listenerMap=new WeakMap,this.suspendDepth=0,e.webRequest.onBeforeRequest.addListener((e=>(this.normalizeDetails(e),0!==this.suspendDepth&&e.tabId>=0?this.suspendOneRequest(e):this.onBeforeSuspendableRequest(e))),this.denormalizeFilters({urls:["http://*/*","https://*/*"]}),["blocking"])}setOptions(){}normalizeDetails(){}denormalizeFilters(e){const t=e.urls||["<all_urls>"];let n=e.types;return Array.isArray(n)&&(n=this.denormalizeTypes(n)),!this.validTypes.has("websocket")||void 0!==n&&-1===n.indexOf("websocket")||-1!==t.indexOf("<all_urls>")||(-1===t.indexOf("ws://*/*")&&t.push("ws://*/*"),-1===t.indexOf("wss://*/*")&&t.push("wss://*/*")),{types:n,urls:t}}denormalizeTypes(e){return e}canonicalNameFromHostname(){}addListener(t,n,s,o){const r=this.denormalizeFilters(s),a=this.makeNewListenerProxy(n);e.webRequest[t].addListener(a,r,o)}onBeforeSuspendableRequest(e){if(void 0!==this.suspendableListener)return this.suspendableListener(e)}setSuspendableListener(e){this.suspendableListener=e}removeListener(t,n){const s=this.listenerMap.get(n);void 0!==s&&(this.listenerMap.delete(n),e.webRequest[t].removeListener(s))}makeNewListenerProxy(e){const t=t=>(this.normalizeDetails(t),e(t));return this.listenerMap.set(e,t),t}suspendOneRequest(){}unsuspendAllRequests(){}suspend(e=!1){(this.canSuspend()||e)&&(this.suspendDepth+=1)}unsuspend(e=!1){0!==this.suspendDepth&&(e?this.suspendDepth=0:this.suspendDepth-=1,0===this.suspendDepth&&this.unsuspendAllRequests())}canSuspend(){return!1}async benchmark(){if("object"!=typeof µBlock)return;const e=await µBlock.loadBenchmarkDataset();if(!1===Array.isArray(e)||0===e.length)return void console.info("No requests found to benchmark");const t=new Map([["document","main_frame"],["subdocument","sub_frame"]]);console.info("vAPI.net.onBeforeSuspendableRequest()...");const n=self.performance.now(),s=[],o={documentUrl:"",tabId:-1,parentFrameId:-1,frameId:0,type:"",url:""};for(const n of e)o.documentUrl=n.frameUrl,o.tabId=-1,o.parentFrameId=-1,o.frameId=0,o.type=t.get(n.cpt)||n.cpt,o.url=n.url,"main_frame"!==o.type&&s.push(this.onBeforeSuspendableRequest(o));return Promise.all(s).then((t=>{let s=0;for(const e of t)void 0!==e&&(s+=1);const o=self.performance.now()-n;console.info(`Evaluated ${e.length} requests in ${o.toFixed(0)} ms`),console.info(`\tBlocked ${s} requests`),console.info(`\tAverage: ${(o/e.length).toFixed(3)} ms per request`)}))}},vAPI.contextMenu=webext.menus&&{_callback:null,_entries:[],_createEntry:function(e){webext.menus.create(JSON.parse(JSON.stringify(e)))},onMustUpdate:function(){},setEntries:function(e,t){e=e||[];let n=Math.max(this._entries.length,e.length);for(let t=0;t<n;t++){const n=this._entries[t],s=e[t];n&&s?s.id!==n&&(webext.menus.remove(n),this._createEntry(s),this._entries[t]=s.id):n&&!s?webext.menus.remove(n):!n&&s&&(this._createEntry(s),this._entries[t]=s.id)}n=this._entries.length=e.length,(t=t||null)!==this._callback&&(0!==n&&null!==t?(webext.menus.onClicked.addListener(t),this._callback=t):0===n&&null!==this._callback&&(webext.menus.onClicked.removeListener(this._callback),this._callback=null))}},vAPI.commands=e.commands,vAPI.adminStorage=webext.storage.managed instanceof Object==0?{get:function(){return Promise.resolve()}}:{get:async function(e){let t;try{t=await webext.storage.managed.get(e)}catch(e){}return"string"==typeof e&&t instanceof Object?t[e]:t}},vAPI.localStorage={start:async function(){return this.cache instanceof Promise||this.cache instanceof Object||(this.cache=webext.storage.local.get("localStorage").then((e=>{this.cache=e instanceof Object&&e.localStorage instanceof Object?e.localStorage:{}}))),this.cache},clear:function(){return this.cache={},webext.storage.local.set({localStorage:this.cache})},getItem:function(e){if(this.cache instanceof Object==0)return console.info(`localStorage.getItem('${e}') not ready`),null;const t=this.cache[e];return void 0!==t?t:null},getItemAsync:async function(e){await this.start();const t=this.cache[e];return void 0!==t?t:null},removeItem:async function(e){this.setItem(e)},setItem:async function(e,t){if(await this.start(),t!==this.cache[e])return this.cache[e]=t,webext.storage.local.set({localStorage:this.cache})},cache:void 0},vAPI.localStorage.start(),vAPI.cloud=(()=>{if(webext.storage.sync instanceof Object==0)return;const e=webext.storage.sync.MAX_ITEMS||512,t=webext.storage.sync.QUOTA_BYTES||102400,n=webext.storage.sync.QUOTA_BYTES_PER_ITEM||8192,s=-16&Math.floor(.75*e),o=function(){return Math.floor(n*(vAPI.webextFlavor.soup.has("firefox")?.6:.75))};let r=o();window.addEventListener("webextFlavor",(function(){r=o()}),{once:!0});const a={defaultDeviceName:window.navigator.platform,deviceName:void 0};vAPI.localStorage.getItemAsync("deviceName").then((e=>{a.deviceName=e}));const i=async function(e){const t={};for(let n=0;n<s;n+=16)t[e+n.toString()]="";let n;try{n=await webext.storage.sync.get(t)}catch(e){return e}let o=0;for(let t=0;t<s&&""!==n[e+t.toString()];t+=16)o=t+16;return o},c=async function(e,t){const n=[],s=await i(e);for(let o=t;o<s;o++)n.push(e+o.toString());0!==n.length&&webext.storage.sync.remove(n)},l=function(e){"function"==typeof e&&e(a)};return{push:async function(e){const{datakey:t,data:n,encode:s}=e;if(void 0===n||"string"==typeof n&&""===n)return c(t,0);const o={source:a.deviceName||a.defaultDeviceName,tstamp:Date.now(),data:n},i=JSON.stringify(o),l=s instanceof Function?await s(i):i,d={},u=Math.ceil(l.length/r);for(let e=0;e<u;e++)d[t+e.toString()]=l.substr(e*r,r);d[t+u.toString()]="";try{await c(t,u+1)}catch(e){}try{await webext.storage.sync.set(d)}catch(e){return String(e)}},pull:async function(e){const{datakey:t,decode:n}=e,s=await i(t);if("number"!=typeof s)return s;const o={};for(let e=0;e<s;e++)o[t+e.toString()]="";let r;try{r=await webext.storage.sync.get(o)}catch(e){return String(e)}let a=[],c=0;for(;;){const e=r[t+c.toString()];if(""===e||void 0===e)break;a.push(e),c+=1}a=a.join("");const l=n instanceof Function?await n(a):a;let d=null;try{d=JSON.parse(l)}catch(e){}return d},used:async function(e){if(webext.storage.sync.getBytesInUse instanceof Function==0)return;const n=await i(e);if("number"!=typeof n)return;const s=[];for(let t=0;t<n;t++)s.push(`${e}${t}`);let o;try{o=await Promise.all([webext.storage.sync.getBytesInUse(s),webext.storage.sync.getBytesInUse(null)])}catch(e){}return!1!==Array.isArray(o)?{used:o[0],total:o[1],max:t}:void 0},getOptions:l,setOptions:function(e,t){"object"==typeof e&&null!==e&&("string"==typeof e.deviceName&&(vAPI.localStorage.setItem("deviceName",e.deviceName),a.deviceName=e.deviceName),l(t))}}})()}