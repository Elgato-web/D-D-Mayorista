"use strict";(()=>{if("object"!=typeof vAPI||vAPI.loadAllLargeMedia instanceof Function)return;const t="data-"+vAPI.sessionId,e=":root   audio["+t+"],\n:root     img["+t+"],\n:root picture["+t+"],\n:root   video["+t+"]",o=function(t){switch(t.localName){case"audio":case"video":return(t.src||"").startsWith("blob:")&&(t.autoplay=!1,t.pause()),0===t.readyState||null!==t.error;case"img":{if(0!==t.naturalWidth||0!==t.naturalHeight)break;const e=window.getComputedStyle(t);return null!==e?"none"!==e.getPropertyValue("display"):0!==t.offsetHeight&&0!==t.offsetWidth}}return!1};if(0===function(){let e=0;for(const n of document.querySelectorAll("audio,img,video"))if(!1!==o(n)&&(n.setAttribute(t,""),e+=1,"img"===n.localName)){const e=n.closest("picture");null!==e&&e.setAttribute(t,"")}return e}())return;void 0===vAPI.largeMediaElementStyleSheet&&(vAPI.largeMediaElementStyleSheet=[e+" {","border: 2px dotted red !important;","box-sizing: border-box !important;","cursor: zoom-in !important;","display: inline-block;","filter: none !important;","font-size: 1rem !important;","min-height: 1em !important;","min-width: 1em !important;","opacity: 1 !important;","outline: none !important;","transform: none !important;","visibility: visible !important;","z-index: 2147483647","}"].join("\n"),vAPI.userStylesheet.add(vAPI.largeMediaElementStyleSheet),vAPI.userStylesheet.apply());const n=async function(t){const e=t.getAttribute("src")||"";t.removeAttribute("src"),await vAPI.messaging.send("scriptlets",{what:"temporarilyAllowLargeMediaElement"}),""!==e&&t.setAttribute("src",e),t.load()},r=async function(t){const e=t.getAttribute("src")||"";t.removeAttribute("src"),await vAPI.messaging.send("scriptlets",{what:"temporarilyAllowLargeMediaElement"}),""!==e&&t.setAttribute("src",e)},i=function(t){for(const e of t)switch(e.localName){case"audio":case"video":n(e);break;case"img":r(e)}},a=function(n){if(0!==n.button||!1===n.isTrusted)return;const r=[],a=document.elementsFromPoint instanceof Function?document.elementsFromPoint(n.clientX,n.clientY):[n.target];for(const n of a)!1!==n.matches(e)&&(n.removeAttribute(t),o(n)&&r.push(n));0!==r.length&&(i(r),n.preventDefault(),n.stopPropagation())};document.addEventListener("click",a,!0);const s=function(t){const e=t.target;if("audio"!==e.localName&&"video"!==e.localName)return;const o=e.src;"string"==typeof o&&!1===o.startsWith("blob:")||(e.autoplay=!1,e.pause())};document.addEventListener("loadeddata",s);const c=function(e){e.target.removeAttribute(t)};document.addEventListener("load",c,!0);const l=function(e){const n=e.target;o(n)&&n.setAttribute(t,"")};document.addEventListener("error",l,!0),vAPI.loadAllLargeMedia=function(){document.removeEventListener("click",a,!0),document.removeEventListener("loadeddata",s,!0),document.removeEventListener("load",c,!0),document.removeEventListener("error",l,!0);const n=[];for(const r of document.querySelectorAll(e))r.removeAttribute(t),o(r)&&n.push(r);i(n)}})();