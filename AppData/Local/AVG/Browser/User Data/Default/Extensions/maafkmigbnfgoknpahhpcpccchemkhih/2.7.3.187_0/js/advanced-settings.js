"use strict";{let n=new Map,e=new Map,t="";CodeMirror.defineMode("raw-settings",(function(){let t="";return{token:function(o){if(o.sol()){o.eatSpace();const r=o.match(/\S+/);return null!==r&&n.has(r[0])?(t=r[0],e.has(r[0])?"readonly keyword":"keyword"):(o.skipToEnd(),"line-cm-error")}o.eatSpace();const r=o.match(/.*$/);if(null!==r){if(r[0].trim()!==n.get(t))return"line-cm-strong";if(e.has(t))return"readonly"}return o.skipToEnd(),null}}}));const o=new CodeMirror(document.getElementById("advancedSettings"),{autofocus:!0,lineNumbers:!0,lineWrapping:!1,styleActiveLine:!0});uBlockDashboard.patchCodeMirrorEditor(o);const r=function(n){const e="string"==typeof n?s(n):i(n);return e.sort(((n,e)=>n[0].localeCompare(e[0]))),JSON.stringify(e)},i=function(n){const e=[];for(const t in n)!1!==n.hasOwnProperty(t)&&e.push([t,`${n[t]}`]);return e},s=function(n){const e=[];for(let t of n.split(/[\n\r]+/)){if(t=t.trim(),""===t)continue;const n=t.indexOf(" ");let o,r;-1!==n?(o=t.slice(0,n),r=t.slice(n+1)):(o=t,r=""),e.push([o.trim(),r.trim()])}return e},a=(()=>{let n;const e=()=>{n=void 0;const e=r(o.getValue())!==t;uDom.nodeFromId("advancedSettingsApply").disabled=!e,CodeMirror.commands.save=e?d:function(){}};return function(){void 0!==n&&clearTimeout(n),n=vAPI.setTimeout(e,100)}})();o.on("changes",a);const c=async function(s){const c=await vAPI.messaging.send("dashboard",{what:"readHiddenSettings"});n=new Map(i(c.default)),e=new Map(i(c.admin)),t=r(c.current);const d=[],u=[],l=i(c.current);let f=0;for(const[n]of l)n.length>f&&(f=n.length);for(let n=0;n<l.length;n++){const[t,o]=l[n];d.push(" ".repeat(f-t.length)+`${t} ${o}`),e.has(t)&&u.push(n)}d.push(""),o.setValue(d.join("\n")),s&&o.clearHistory();for(const n of u)o.markText({line:n,ch:0},{line:n+1,ch:0},{readOnly:!0});a(),o.focus()},d=async function(){await vAPI.messaging.send("dashboard",{what:"writeHiddenSettings",content:o.getValue()}),c()};uDom.nodeFromId("advancedSettings").addEventListener("input",a),uDom.nodeFromId("advancedSettingsApply").addEventListener("click",(()=>{d()})),c(!0)}